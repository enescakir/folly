# This file was @generated by getdeps.py

name: linux

on:
  push:
    branches:
    - build-test

jobs:
  build:
    strategy:
      matrix:
        runs-on: [ubuntu-latest, ubicloud-standard-2, ubicloud-standard-4, ubicloud-standard-8, ubicloud-standard-16, buildjet-2vcpu-ubuntu-2204, buildjet-4vcpu-ubuntu-2204, buildjet-8vcpu-ubuntu-2204, buildjet-16vcpu-ubuntu-2204]
    name: CI ${{matrix.runs-on}}
    runs-on: ${{matrix.runs-on}}
    steps:
    - name: cat /proc/cpuinfo
      run: cat /proc/cpuinfo

    - name: uname -mr
      run: uname -mr

    - name: lsblk
      run: lsblk

    - name: df -Th
      run: df -Th

    - name: lspci
      run: lspci -vv
  
    - name: install fio
      run: sudo apt-get -y install fio

    - name: run fio
      run: |
        sudo fio --filename=./f --size=2GB --direct=1 --rw=randrw --bs=4k --ioengine=libaio \
          --iodepth=256 --runtime=30 --numjobs=4 --time_based --group_reporting \
          --name=iops-test-job --eta-newline=1
